# Video Generator Architecture

> **Version:** 2.2  
> **Last Updated:** February 2026  
> **Purpose:** Complete architecture overview with workflows and data flows

---

## Overview

The Video Generator is an AI-orchestrated system that creates professional product demo videos with voiceover, captions, and talking heads. It's designed to be used by AI agents (Claude) who read request files, make decisions, and execute commands.

**Key Principles:**
1. **Everything goes through a request file** â€” Even conversational prompts create one first
2. **AI decides, Python executes** â€” Tools are "dumb executors", AI calculates placements
3. **Iteration is easy** â€” Request files store timeline markers for re-runs without re-recording

---

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              USER INTERACTION                                â”‚
â”‚                                                                             â”‚
â”‚  "Make me a demo of Improvado"    OR    "Use requests/demo.md"              â”‚
â”‚               â”‚                                   â”‚                         â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                             â–¼                                               â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚                  â”‚    REQUEST FILE     â”‚  â† Everything flows through this   â”‚
â”‚                  â”‚  requests/demo.md   â”‚                                    â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           AI AGENT (Claude)                                  â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  1. Read SKILL.md (auto-discovered)                                   â”‚  â”‚
â”‚  â”‚  2. Ensure request file exists (create from prompt if needed)         â”‚  â”‚
â”‚  â”‚  3. Parse request: URL, auth, scenario, narration, options            â”‚  â”‚
â”‚  â”‚  4. Record browser OR use existing video                              â”‚  â”‚
â”‚  â”‚  5. Apply edits, calculate audio placements                           â”‚  â”‚
â”‚  â”‚  6. Compose final video                                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                   â–¼                â–¼                â–¼                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚           â”‚   Record     â”‚ â”‚    Audio     â”‚ â”‚   Compose    â”‚               â”‚
â”‚           â”‚   Browser    â”‚ â”‚    TTS       â”‚ â”‚   Video      â”‚               â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              VG CLI (Python)                                 â”‚
â”‚                                                                             â”‚
â”‚   vg record     vg audio      vg edit       vg compose     vg captions     â”‚
â”‚   vg talking-head            vg quality     vg request     vg run           â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        Core Modules                                    â”‚ â”‚
â”‚  â”‚  vg_recording.py  vg_tts.py  vg_edit.py  vg_compose.py  vg_captions.pyâ”‚ â”‚
â”‚  â”‚  vg_run.py  (evaluation system)                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â–¼                â–¼                â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  Playwright  â”‚ â”‚  ElevenLabs  â”‚ â”‚    FFmpeg    â”‚
           â”‚  (Browser)   â”‚ â”‚  (TTS API)   â”‚ â”‚  (Video)     â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                â”‚                â”‚
                   â–¼                â–¼                â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  recording   â”‚ â”‚   audio/     â”‚ â”‚  final.mp4   â”‚
           â”‚  .webm       â”‚ â”‚   *.mp3      â”‚ â”‚              â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Request File Formats

### Format Comparison

| Feature | Legacy Format | Agentic Format |
|---------|--------------|----------------|
| **File size** | ~200 lines | ~60 lines |
| **Detail level** | Explicit markers, tables | Intent-based descriptions |
| **Marker anchors** | AI parses from tables | AI infers from narration |
| **Timing** | Explicit offsets | AI calculates |
| **Best for** | Repeatable, precise control | Quick iteration |

### Legacy Format (Detailed)

```markdown
# requests/improvado_ai_agent_demo.md

## Platform
**Name:** Improvado
**URL:** https://app.example.com

## Authentication
**Cookie Name:** session_id
**Cookie Value:** Use environment variable `SESSION_TOKEN`

## Scenario Flow
### Step 1: Open and Wait
- Navigate to URL
- Wait for page to load
...

<!-- VOICEOVER_SEGMENTS_START -->
| Segment | Anchor Marker | Offset | Text |
|---------|---------------|--------|------|
| intro | t_page_loaded | 0.5s | Welcome to... |
| prompt1 | t_prompt1_focus | 0.2s | Watch how... |
<!-- VOICEOVER_SEGMENTS_END -->

## Options
### Editing
- **Trim Start:** 8 seconds
- **Speed Gaps:** yes, 3x
```

### Agentic Format (Simplified)

```markdown
# requests/improvado_ai_agent_agentic.md

## Platform
**URL:** https://app.example.com

## Authentication
**Cookie Name:** dts_sessionid
**Cookie Value:** Use environment variable `DTS_SESSIONID`

## Goal
Record a demo showing the AI Agent creating a dashboard.

## Scenario Flow
1. Navigate to URL and wait for load
2. Type: "Create marketing dashboard"
3. Press Enter, wait for AI to finish
4. Scroll to show results

## Narration
1. **intro** (after page loads): "Welcome to..."
2. **typing** (when typing starts): "Watch how..."
3. **reveal** (when result appears): "Here's your..."

## Options
- **Voiceover:** yes
- **Speed gaps:** yes, 3x
- **Trim start:** 8 seconds
```

---

## Unified Workflow

**Everything flows through a request file.** Even conversational prompts create one first.

### Decision Tree

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER REQUEST                                     â”‚
â”‚                                                                         â”‚
â”‚  "Make me a demo of Improvado"    OR    "Use requests/demo.md"          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: Ensure Request File Exists                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Has request file?                                                      â”‚
â”‚  â”œâ”€â”€ YES â†’ Parse it                                                     â”‚
â”‚  â””â”€â”€ NO  â†’ AI creates one (agentic format)                              â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚            â”‚  AI gathers from user:                         â”‚           â”‚
â”‚            â”‚  - URL to record                               â”‚           â”‚
â”‚            â”‚  - Authentication method                       â”‚           â”‚
â”‚            â”‚  - What to show (scenario)                     â”‚           â”‚
â”‚            â”‚  - What to say (narration)                     â”‚           â”‚
â”‚            â”‚  - Options (voiceover, speed-gaps, etc.)       â”‚           â”‚
â”‚            â”‚                                                â”‚           â”‚
â”‚            â”‚  Creates: requests/<name>.md                   â”‚           â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: Recording (or skip if video exists)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Has existing video? (--skip-record --video v.mp4)                      â”‚
â”‚  â”œâ”€â”€ YES â†’ Skip to Step 3                                               â”‚
â”‚  â””â”€â”€ NO  â†’ Record browser                                               â”‚
â”‚            â”‚                                                            â”‚
â”‚            â”œâ”€â”€ SIMPLE (known platform, actions table)?                  â”‚
â”‚            â”‚   â†’ $ vg request generate --file demo.md                   â”‚
â”‚            â”‚     (automated recording)                                  â”‚
â”‚            â”‚                                                            â”‚
â”‚            â””â”€â”€ COMPLEX (new platform, conditional logic)?               â”‚
â”‚                â†’ Session recording (AI drives browser)                  â”‚
â”‚                  snapshot â†’ think â†’ act â†’ verify                        â”‚
â”‚                                                                         â”‚
â”‚  Output: recording.webm + timeline.md (markers with times)              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: Edit Video                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Apply edits from request Options:                                      â”‚
â”‚  - Trim start/end                                                       â”‚
â”‚  - Speed up gaps (3x)                                                   â”‚
â”‚  - Cut sections                                                         â”‚
â”‚                                                                         â”‚
â”‚  Each edit returns adjustments â†’ AI recalculates marker times           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 4: Generate Audio & Compose                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  For each narration segment in request:                                 â”‚
â”‚  1. Generate TTS â†’ get duration                                         â”‚
â”‚  2. Calculate placement time from adjusted markers                      â”‚
â”‚  3. Place audio at exact times                                          â”‚
â”‚                                                                         â”‚
â”‚  Optional: Add talking heads, captions                                  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚  final.mp4   â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## The Complete Flow (Detailed)

Whether user provides a request file or asks conversationally, the flow is the same:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1: REQUEST FILE                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  User says: "Make me a demo of Improvado AI Agent"                       â”‚
â”‚                                                                          â”‚
â”‚  AI asks (if needed):                                                    â”‚
â”‚  - "What URL should I record?"                                           â”‚
â”‚  - "How do I authenticate? (cookie, login, none)"                        â”‚
â”‚  - "What should the video show?"                                         â”‚
â”‚  - "What narration do you want?"                                         â”‚
â”‚                                                                          â”‚
â”‚  AI creates: requests/improvado_demo.md                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ## Platform                                                         â”‚ â”‚
â”‚  â”‚ **URL:** https://report.improvado.io/...                            â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚ ## Authentication                                                   â”‚ â”‚
â”‚  â”‚ **Cookie Name:** dts_sessionid                                      â”‚ â”‚
â”‚  â”‚ **Cookie Value:** Use environment variable `DTS_SESSIONID`          â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚ ## Scenario Flow                                                    â”‚ â”‚
â”‚  â”‚ 1. Navigate to URL, wait for load                                   â”‚ â”‚
â”‚  â”‚ 2. Type: "Create marketing dashboard"                               â”‚ â”‚
â”‚  â”‚ 3. Wait for AI to finish                                            â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚ ## Narration                                                        â”‚ â”‚
â”‚  â”‚ 1. **intro** (after page loads): "Welcome to..."                    â”‚ â”‚
â”‚  â”‚ 2. **reveal** (when result appears): "Here's your..."               â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚ ## Options                                                          â”‚ â”‚
â”‚  â”‚ - **Voiceover:** yes                                                â”‚ â”‚
â”‚  â”‚ - **Speed gaps:** yes, 3x                                           â”‚ â”‚
â”‚  â”‚ - **Trim start:** 8 seconds                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                          â”‚
â”‚  OR user provides: requests/improvado_ai_agent_demo.md (already exists)  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2: RECORDING                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Option A: Automated (request has Actions table)                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                           â”‚
â”‚  $ vg request generate --file requests/demo.md                           â”‚
â”‚                                                                          â”‚
â”‚  Pipeline reads Actions table, executes each step, records markers.      â”‚
â”‚                                                                          â”‚
â”‚                                                                          â”‚
â”‚  Option B: Session-based (new platform, no Actions table)                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚
â”‚  AI drives the browser interactively:                                    â”‚
â”‚                                                                          â”‚
â”‚  $ vg record session start --run-id demo --url "..." --request demo.md   â”‚
â”‚                                                                          â”‚
â”‚  Loop:                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  $ vg record session do --action snapshot                           â”‚ â”‚
â”‚  â”‚  â†’ Returns: elements, state                                         â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚  AI thinks: "I see textarea, need to click it"                      â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚  $ vg record session do --action click --selector "textarea"        â”‚ â”‚
â”‚  â”‚  $ vg record session do --action marker --value "t_prompt1_focus"   â”‚ â”‚
â”‚  â”‚  $ vg record session do --action type --selector "textarea" \       â”‚ â”‚
â”‚  â”‚      --value "Create dashboard" --delay-ms 45                       â”‚ â”‚
â”‚  â”‚  $ vg record session do --action press --value "Enter"              â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚  ... verify with snapshot, continue until done ...                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                          â”‚
â”‚  $ vg record session stop --run-id demo                                  â”‚
â”‚  â†’ Returns: video path, duration, markers                                â”‚
â”‚                                                                          â”‚
â”‚                                                                          â”‚
â”‚  Option C: Skip recording (existing video)                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                               â”‚
â”‚  $ vg request generate --file demo.md --skip-record --video existing.mp4 â”‚
â”‚                                                                          â”‚
â”‚  Uses timeline markers already in the request file (from previous run).  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3: TIMELINE (markers from recording)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  timeline.md (or appended to request file):                              â”‚
â”‚                                                                          â”‚
â”‚  | Marker                | Time (s) |                                    â”‚
â”‚  |-----------------------|----------|                                    â”‚
â”‚  | t_start_recording     | 0.00     |                                    â”‚
â”‚  | t_page_loaded         | 33.11    |                                    â”‚
â”‚  | t_prompt1_focus       | 107.15   |                                    â”‚
â”‚  | t_processing1_started | 123.22   |                                    â”‚
â”‚  | t_agent_done_1        | 260.79   |                                    â”‚
â”‚  | t_scroll_start        | 352.76   |                                    â”‚
â”‚                                                                          â”‚
â”‚  These markers are the synchronization points for audio placement.       â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 4: EDITING                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Apply edits from Options, each returns adjustments:                     â”‚
â”‚                                                                          â”‚
â”‚  $ vg edit trim --video v.mp4 --start 8 -o trimmed.mp4                   â”‚
â”‚  â†’ Returns: {"adjustment": {"type": "offset", "seconds": -8}}            â”‚
â”‚                                                                          â”‚
â”‚  AI recalculates: 33.11 - 8 = 25.11                                      â”‚
â”‚                                                                          â”‚
â”‚  $ vg edit speed-gaps --video trimmed.mp4 --factor 3 -o fast.mp4         â”‚
â”‚  â†’ Returns: {"time_map": [[25.11, 10.2], [99.15, 42.3], ...]}            â”‚
â”‚                                                                          â”‚
â”‚  AI uses time_map to find new positions for each marker.                 â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 5: AUDIO GENERATION                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  For each narration segment:                                             â”‚
â”‚                                                                          â”‚
â”‚  $ vg audio tts --text "Welcome to Improvado..." -o intro.mp3            â”‚
â”‚  â†’ Returns: {"duration_s": 4.2, "path": "audio/intro.mp3"}               â”‚
â”‚                                                                          â”‚
â”‚  $ vg audio tts --text "Watch how easy..." -o prompt1.mp3                â”‚
â”‚  â†’ Returns: {"duration_s": 3.8, "path": "audio/prompt1.mp3"}             â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 6: COMPOSITION                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  AI calculates final placements:                                         â”‚
â”‚                                                                          â”‚
â”‚  | Segment | Anchor         | Offset | Mapped Time | Final    |          â”‚
â”‚  |---------|----------------|--------|-------------|----------|          â”‚
â”‚  | intro   | t_page_loaded  | 0.5s   | 10.2        | 10.7s    |          â”‚
â”‚  | prompt1 | t_prompt1_focus| 0.2s   | 42.3        | 42.5s    |          â”‚
â”‚  | reveal  | t_agent_done_1 | 0.5s   | 98.5        | 99.0s    |          â”‚
â”‚                                                                          â”‚
â”‚  $ vg compose place --video fast.mp4 \                                   â”‚
â”‚      --audio intro.mp3:10.7 \                                            â”‚
â”‚      --audio prompt1.mp3:42.5 \                                          â”‚
â”‚      --audio reveal.mp3:99.0 \                                           â”‚
â”‚      -o final.mp4                                                        â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 7: OPTIONAL ENHANCEMENTS                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Talking heads (if enabled):                                             â”‚
â”‚  # Option A: One-step (TTS + generate)                                   â”‚
â”‚  $ vg talking-head create --text "Welcome..." -o th_intro.mp4            â”‚
â”‚  # Returns: {"duration_s": 4.2}                                          â”‚
â”‚                                                                          â”‚
â”‚  # Option B: Two-step (from existing audio)                              â”‚
â”‚  $ vg talking-head generate --audio intro.mp3 -o th_intro.mp4            â”‚
â”‚                                                                          â”‚
â”‚  # Overlay at AI-calculated time                                         â”‚
â”‚  $ vg talking-head overlay --video final.mp4 \                           â”‚
â”‚      --overlay th_intro.mp4:10.7 --position bottom-right -o with_th.mp4  â”‚
â”‚                                                                          â”‚
â”‚  Captions (if enabled):                                                  â”‚
â”‚  $ vg captions streaming --video final.mp4 --request demo.md \           â”‚
â”‚      --timeline timeline.md --audio-dir audio/ -o captioned.mp4          â”‚
â”‚                                                                          â”‚
â”‚  Or standard SRT burn-in:                                                â”‚
â”‚  $ vg captions generate --request demo.md --timeline timeline.md \       â”‚
â”‚      --audio-dir audio/ -o captions.srt                                  â”‚
â”‚  $ vg captions burn --video final.mp4 --captions captions.srt \          â”‚
â”‚      --style youtube -o captioned.mp4                                    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚  final.mp4   â”‚
                           â”‚  Complete!   â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Iteration: Refining the Video

After first run, the request file has real timeline markers. User can iterate:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ITERATION WORKFLOW                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  First run: Recording captured, timeline markers saved to request file   â”‚
â”‚                                                                          â”‚
â”‚  <!-- TIMELINE_MARKERS_START -->                                         â”‚
â”‚  | t_page_loaded | 33.11 |                                               â”‚
â”‚  | t_agent_done_1 | 260.79 |  â† Processing took 227 seconds!             â”‚
â”‚  <!-- TIMELINE_MARKERS_END -->                                           â”‚
â”‚                                                                          â”‚
â”‚  User reviews: "Processing is too long, let's add filler narration"      â”‚
â”‚                                                                          â”‚
â”‚  AI updates Narration section:                                           â”‚
â”‚  + **processing1** (during AI work): "The AI is analyzing your data..."  â”‚
â”‚  + **processing2** (15s later): "Building your dashboard layout..."      â”‚
â”‚                                                                          â”‚
â”‚  Re-run with existing video:                                             â”‚
â”‚  $ vg request generate --file demo.md --skip-record --video recording.mp4â”‚
â”‚                                                                          â”‚
â”‚  â†’ New audio, same video, perfect sync                                   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Timeline Markers

Timeline markers are the synchronization points between video and audio.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         RECORDING PHASE                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
     Browser actions create markers â”‚
                                    â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  timeline.md (generated during recording)                     â”‚
     â”‚                                                               â”‚
     â”‚  | Marker | Time (s) |                                        â”‚
     â”‚  |--------|----------|                                        â”‚
     â”‚  | t_start_recording | 0.00 |                                 â”‚
     â”‚  | t_page_loaded | 33.11 |                                    â”‚
     â”‚  | t_prompt1_focus | 107.15 |                                 â”‚
     â”‚  | t_prompt1_typed | 116.40 |                                 â”‚
     â”‚  | t_processing1_started | 123.22 |                           â”‚
     â”‚  | t_agent_done_1 | 260.79 |                                  â”‚
     â”‚  | t_prompt2_focus | 272.98 |                                 â”‚
     â”‚  | t_agent_done_2 | 347.75 |                                  â”‚
     â”‚  | t_scroll_start | 352.76 |                                  â”‚
     â”‚  | t_recording_complete | 369.99 |                            â”‚
     â”‚                                                               â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         EDITING PHASE                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
     $ vg edit trim --start 8      â”‚  Adjustment: -8s
                                    â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  After Trim (AI recalculates)                                 â”‚
     â”‚                                                               â”‚
     â”‚  | Marker | Original | After Trim |                           â”‚
     â”‚  |--------|----------|------------|                           â”‚
     â”‚  | t_page_loaded | 33.11 | 25.11 |                            â”‚
     â”‚  | t_prompt1_focus | 107.15 | 99.15 |                         â”‚
     â”‚  | t_agent_done_1 | 260.79 | 252.79 |                         â”‚
     â”‚                                                               â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
     $ vg edit speed-gaps --factor 3 â”‚  Returns time_map
                                    â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  After Speed-Gaps (time_map from tool)                        â”‚
     â”‚                                                               â”‚
     â”‚  time_map: [                                                  â”‚
     â”‚    [25.11, 10.2],    # t_page_loaded: 25.11 â†’ 10.2            â”‚
     â”‚    [99.15, 42.3],    # t_prompt1_focus: 99.15 â†’ 42.3          â”‚
     â”‚    [252.79, 98.5],   # t_agent_done_1: 252.79 â†’ 98.5          â”‚
     â”‚  ]                                                            â”‚
     â”‚                                                               â”‚
     â”‚  scale_factor: 0.38 (video compressed to 38% of length)       â”‚
     â”‚                                                               â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AUDIO PLACEMENT                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
     AI uses mapped times           â”‚
                                    â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  Final Placements (calculated by AI)                          â”‚
     â”‚                                                               â”‚
     â”‚  | Segment | Anchor | Offset | Final Time |                   â”‚
     â”‚  |---------|--------|--------|------------|                   â”‚
     â”‚  | intro | t_page_loaded | 0.5s | 10.7s |                     â”‚
     â”‚  | prompt1 | t_prompt1_focus | 0.2s | 42.5s |                 â”‚
     â”‚  | reveal1 | t_agent_done_1 | 0.5s | 99.0s |                  â”‚
     â”‚                                                               â”‚
     â”‚  $ vg compose place --video fast.mp4 \                        â”‚
     â”‚      --audio intro.mp3:10.7 \                                 â”‚
     â”‚      --audio prompt1.mp3:42.5 \                               â”‚
     â”‚      --audio reveal1.mp3:99.0 \                               â”‚
     â”‚      -o final.mp4                                             â”‚
     â”‚                                                               â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Output Structure

```
videos/runs/<run_id>/
â”œâ”€â”€ raw/
â”‚   â”œâ”€â”€ recording.webm         # Original browser recording
â”‚   â””â”€â”€ screenshots/           # Debug screenshots at key moments
â”œâ”€â”€ audio/
â”‚   â”œâ”€â”€ intro.mp3              # TTS segments
â”‚   â”œâ”€â”€ prompt1.mp3
â”‚   â”œâ”€â”€ processing1.mp3
â”‚   â”œâ”€â”€ reveal1.mp3
â”‚   â””â”€â”€ ...
â”œâ”€â”€ timeline.md                # Extracted markers with timestamps
â”œâ”€â”€ demo.mp4                   # Converted from webm
â”œâ”€â”€ trimmed.mp4                # After trim
â”œâ”€â”€ fast.mp4                   # After speed-gaps
â”œâ”€â”€ final.mp4                  # Final output with audio
â””â”€â”€ run_report.md              # Metadata, issues, screenshots
```

### Evaluation Output

```
evaluations.md                    # Central evaluation file for all runs
runs_dashboard.html              # HTML dashboard table (optional)
```

---

## Runs Evaluation System

The Runs Evaluation System provides comprehensive quality assurance and performance monitoring for every video generation run. It automatically evaluates runs for issues using advanced technical metrics, generates actionable recommendations, and tracks trends over time.

### Architecture Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           EVALUATION SYSTEM                                  â”‚
â”‚                                                                             â”‚
â”‚  Automatic Evaluation â†’ Technical Analysis â†’ Quality Scoring â†’ Reports     â”‚
â”‚                                                                             â”‚
â”‚  ğŸ“Š Quality metrics for video, audio, sync, performance                     â”‚
â”‚  ğŸ“‹ Markdown reports in evaluations.md                                     â”‚
â”‚  ğŸ¯ Actionable recommendations for improvement                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Core Features

| Feature | Description | Commands |
|---------|-------------|----------|
| **Smart Evaluation** | Technical analysis with quality scoring and recommendations | `vg run evaluate --run-id <id>` |
| **Automatic Reports** | Markdown reports in evaluations.md with all run details | Automatic after generation |
| **Dashboard View** | Clean HTML table of all runs with status indicators | `vg run dashboard` |
| **Trend Tracking** | Success rates and quality metrics across runs | `vg run list` / `vg run summary` |

### Smart Evaluation Features

**Technical Analysis:** Video codec/resolution/bitrate, audio quality/sync, compression efficiency
**Quality Scoring:** 0.0-1.0 algorithm-based metrics for each phase
**Issue Detection:** Automatic identification of technical problems and missing elements
**Recommendations:** Actionable suggestions based on detected issues

### Output: evaluations.md

Central markdown file with all run evaluations, technical details, and improvement suggestions.


### Integration with Workflow

**AUTOMATIC EVALUATION**: Runs immediately after every `vg request generate` command.

```
AI Agent Workflow:
1. Create/Update Request File
                   â†“
2. Run: vg request generate --file demo.md
                   â†“
3. Video Generation + Automatic Evaluation
                   â†“
4. Check Returned evaluation Object
                   â†“
5. Apply Recommendations if Needed
                   â†“
6. Iterate Easily (evaluation guides improvements)
```

### Central evaluations.md File

All evaluations stored in single markdown file with summary and detailed technical reports.
**Quality Score:** 0.94/1.0
### Issues
None
### Recommendations
- Consider speed-gaps for long sections
```

### CLI Commands

#### Evaluate & Analyze
```bash
vg run evaluate --run-id demo           # Evaluate specific run
vg run evaluate --last                  # Evaluate most recent run
vg run list                             # List all runs
vg run summary --days 7                 # 7-day statistics
vg run dashboard                        # Generate HTML dashboard
```

### Quality Gates & Automation

The evaluation system enables automated quality assurance:

- **Pre-deployment Checks**: Verify runs meet quality thresholds
- **Regression Detection**: Alert on declining success rates
- **Performance Monitoring**: Track generation time trends
- **Issue Pattern Recognition**: Identify common failure modes

### Output Enhancement

Evaluations are stored in the run directory:

```
evaluations.md                    # Central evaluation file for all runs
videos/runs/<run_id>/             # Video output directories (no per-run eval files)
â”œâ”€â”€ final.mp4
â””â”€â”€ ... (existing files)
```

---

## Component Reference

### Recording Components

| Component | Purpose | Key Files |
|-----------|---------|-----------|
| **Session Recording** | AI-driven browser control (CSS selectors) | `vg_session_simple.py` |
| **agent-browser Recording** | AI-driven browser control (ref-based) | `vg_agent_browser.py` |
| **Automated Recording** | Action-table execution | `vg_recording.py` |
| **Smart Waiting** | Detect AI completion | `vg_smart_waiting.py` |
| **Timeline** | Marker management | `vg_core_utils/timeline.py` |
| **Captions** | SRT generation, burn-in, streaming | `vg_captions.py` |

### Dual Browser Driver Architecture

The Video Generator supports two browser automation drivers for recording:

| Driver | Selector Method | Best For | Commands |
|--------|----------------|----------|----------|
| **current** (Playwright) | CSS selectors | Known platforms, stable UIs | `vg record session start/do/stop` |
| **agent-browser** (Vercel Labs) | Element refs (@e1, @e2) | New platforms, dynamic UIs | `vg record session agent-start/do/stop` |

**Selecting a driver:**
- Set `Browser Driver: agent-browser` in request file Options section
- Or omit for default Playwright driver

**agent-browser advantages:**
- Refs from accessibility tree are more stable than CSS selectors
- AI can read snapshot and pick best ref for action
- Less breakage when UIs change (button moved, class renamed)

**Both drivers produce identical output:**
- `.webm` video file in `raw/` directory
- `timeline.md` with marker timestamps
- Compatible with all editing, TTS, and composition commands

### Audio Components

| Component | Purpose | Key Files |
|-----------|---------|-----------|
| **TTS Generation** | Text-to-speech via ElevenLabs | `vg_tts.py`, `elevenlabs_tts.py` |
| **Audio Caching** | MD5-based 24h cache | `vg_common.py` |

### Video Components

| Component | Purpose | Key Files |
|-----------|---------|-----------|
| **Editing** | Trim, cut, speed, concat | `vg_edit.py` |
| **Composition** | Audio placement, overlay | `vg_compose.py` |
| **Captions** | SRT generation, burn-in | `vg_captions.py` |
| **Talking Heads** | AI presenter (create, generate, overlay) | `vg_talking_head.py`, `vg_commands/talking_head.py` |
| **Title Cards** | AI-generated titles (Grok Imagine Video) | `vg_commands/talking_head.py` |

---

## API Keys Required

| Service | Environment Variable | Purpose |
|---------|---------------------|---------|
| ElevenLabs | `ELEVENLABS_API_KEY` | Text-to-speech |
| FAL.ai | `FAL_API_KEY` | Talking heads, title cards (Grok Imagine Video) |
| Platform Auth | `DTS_SESSIONID` (example) | Browser authentication |

---

## Error Handling

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Error Classification                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  TRANSIENT        â†’ Network/API issues â†’ Retry with backoff             â”‚
â”‚  VALIDATION       â†’ Bad input â†’ Fix parameters                          â”‚
â”‚  AUTH_ERROR       â†’ Missing API key â†’ Set environment variable          â”‚
â”‚  FILE_NOT_FOUND   â†’ Bad path â†’ Check file exists                        â”‚
â”‚  CONFIG_ERROR     â†’ Setup issue â†’ Check dependencies                    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

All CLI commands provide clear success/error feedback with actionable error messages.

---

## Quick Reference

### Automated Pipeline
```bash
vg request generate --file demo.md
```

### Skip Recording (Use Existing Video)
```bash
vg request generate --file demo.md --skip-record --video existing.mp4
```

### Session-Based Recording (Playwright - CSS selectors)
```bash
vg record session start --run-id demo --url "..." --request demo.md
vg record session do --run-id demo --action snapshot
vg record session do --run-id demo --action click --selector "textarea"
vg record session do --run-id demo --action marker --value "t_prompt1_focus"
vg record session stop --run-id demo
```

### agent-browser Recording (ref-based - recommended for new platforms)
```bash
vg record session agent-start --run-id demo --url "..." --cookie "session=abc" --cookie-domain ".example.com"
vg record session agent-do --run-id demo --action snapshot -i    # Get refs
vg record session agent-do --run-id demo --action click --ref "@e5"
vg record session agent-do --run-id demo --action type --ref "@e12" --value "Create dashboard"
vg record session agent-do --run-id demo --action marker --value "t_prompt1_focus"
vg record session agent-stop --run-id demo
```

### Agentic Composition
```bash
vg audio tts --text "Welcome..." -o intro.mp3        # Returns duration
vg edit trim --video v.mp4 --start 8 -o trimmed.mp4  # Returns adjustment
vg edit speed-gaps --video v.mp4 --factor 3 -o fast.mp4  # Returns time_map
vg compose place --video fast.mp4 --audio intro.mp3:10.2 -o final.mp4
```

### Talking Heads & Title Cards
```bash
vg talking-head create --text "Hi!" -o th.mp4        # Square TH for PiP overlay
vg talking-head intro --text "Welcome!" -o intro.mp4 # Fullscreen YouTuber-style
vg talking-head title --text "Part 2" -o title.mp4   # AI title card (Grok Imagine)
vg talking-head overlay --video v.mp4 --overlay th.mp4:10.2 -o final.mp4
```

### Run Evaluation & Analytics
```bash
vg run evaluate --run-id demo                    # Evaluate specific run
vg run evaluate --last                           # Evaluate most recent run
vg run list --limit 10                           # List recent evaluations
vg run list --status failure --limit 5           # Show failed runs
vg run summary --days 7                          # 7-day summary statistics
```

---

## See Also

- **[SKILL.md](.claude/skills/video-generator/SKILL.md)** â€” AI workflow guide
- **[TOOLS.md](.claude/skills/video-generator/docs/TOOLS.md)** â€” CLI parameters
- **[EXAMPLES.md](.claude/skills/video-generator/docs/EXAMPLES.md)** â€” Workflow examples
- **[requests/_template_agentic.md](requests/_template_agentic.md)** â€” Request file template
